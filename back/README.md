# SubtleGram Backend

AI-powered –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –Ω–∞ –±–∞–∑–µ Qwen 3 Next.

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—É–±—Ç–∏—Ç—Ä—ã –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—Ç—å:
- **–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è**
- **–û–±—ä—è—Å–Ω–µ–Ω–∏—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏** –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Å–ª–µ–Ω–≥–∞** –∏–∑ Urban Dictionary
- **–£—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** (B1, C1 –∏ —Ç.–¥.)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
cd back
npm install
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
PORT=3001
NODE_ENV=development
HF_TOKEN=your_hugging_face_token_here
FRONTEND_URL=http://localhost:3000
```

### –ó–∞–ø—É—Å–∫
```bash
npm run dev  # —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm start    # –ø—Ä–æ–¥–∞–∫—à–Ω
```

–°–µ—Ä–≤–µ—Ä: `http://localhost:3001`

## üìÅ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ controllers/         # –û–±—Ä–∞–±–æ—Ç–∫–∞ API –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ uploadController.ts    # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ analyzeController.ts   # –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ –∫–ª–∏–∫—É
‚îú‚îÄ‚îÄ routes/              # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ subtitles.ts           # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å—É–±—Ç–∏—Ç—Ä–æ–≤
‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ qwenService.ts         # –ö–ª–∏–µ–Ω—Ç Qwen AI (–Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)
‚îÇ   ‚îú‚îÄ‚îÄ analysisService.ts     # –õ–æ–≥–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ slangService.ts        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Urban Dictionary
‚îú‚îÄ‚îÄ utils/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.ts              # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ tokenization.ts        # –†–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Ç–æ–∫–µ–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ sentenceUtils.ts       # –†–∞–±–æ—Ç–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ validation.ts          # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ types/               # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ index.ts               # –í—Å–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤
‚îî‚îÄ‚îÄ index.ts             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ Express —Å–µ—Ä–≤–µ—Ä–∞
```

## üîß API

### Health Check
```http
GET /health
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
```http
POST /api/subtitles/upload
Content-Type: multipart/form-data

file: subtitle.srt
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** SRT, VTT, TXT —Ñ–∞–π–ª—ã –¥–æ 10MB

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
```http
POST /api/subtitles/analyze
Content-Type: application/json

{
  "subtitles": [...],  // –º–∞—Å—Å–∏–≤ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
  "sentenceText": "I gotta go home now.",  // —Ç–µ–∫—Å—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
  "context": {         // –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    "prev": "Hello there",
    "next": "See you later"
  }
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. **–ê–Ω–∞–ª–∏–∑ AI** - Qwen –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
2. **–°–ª–µ–Ω–≥** - –∏–∑–≤–ª–µ–∫–∞–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑ Urban Dictionary
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Ç–æ–≥–æ –∂–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- **–ü–µ—Ä–µ–≤–æ–¥** –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ü–µ–ª–∏–∫–æ–º
- **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ** –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏ –∏ —Å–ª–µ–Ω–≥–∞
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è** —Å–ª–µ–Ω–≥–∞ –∏–∑ Urban Dictionary
- **–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** (B1, C1 –∏ —Ç.–¥.)

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã

```bash
npm run dev               # —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
npm run build             # —Å–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
npm start                 # –∑–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
npm run test-integration  # –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ–º
npm run test-ud-api       # —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Urban Dictionary API
npm run lint              # –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
npm run type-check        # –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
```

## ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|-------------|
| `PORT` | –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ | `3001` |
| `HF_TOKEN` | Hugging Face API —Ç–æ–∫–µ–Ω | *–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ* |
| `FRONTEND_URL` | URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ | `http://localhost:3000` |
| `NODE_ENV` | –°—Ä–µ–¥–∞ | `development` |

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Rate limiting (100 –∑–∞–ø—Ä–æ—Å–æ–≤/15–º–∏–Ω)
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ (SRT, VTT, TXT –¥–æ 10MB)
- CORS –∑–∞—â–∏—Ç–∞
- Helmet.js HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
npm run test-integration  # —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
npm run test-ud-api       # –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Urban Dictionary
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Urban Dictionary API
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∏ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Node.js + Express** - API —Å–µ—Ä–≤–µ—Ä
- **TypeScript** - —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **Qwen 3 Next** - AI –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ Hugging Face
- **Urban Dictionary API** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª–µ–Ω–≥–∞
- **sentence-splitter** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- **Multer** - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- **Rate limiting + CORS + Helmet** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

## üìù –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ü–∏—è

1. `npm run lint:fix` - –ª–∏–Ω—Ç–∏–Ω–≥
2. `npm run type-check` - —Ç–∏–ø—ã
3. `npm run test-integration` - –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
4. –°–æ–∑–¥–∞–π—Ç–µ PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—É–±—Ç–∏—Ç—Ä—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SRT, VTT, TXT —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –¢–µ–∫—Å—Ç —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–æ–∫–µ–Ω—ã —Å –ø–æ–∑–∏—Ü–∏—è–º–∏

### 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ —Å–ª–æ–≤–æ
- –ü–æ –ø–æ–∑–∏—Ü–∏–∏ –∫—É—Ä—Å–æ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
- –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏ —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)

### 3. AI –∞–Ω–∞–ª–∏–∑
- Qwen –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –í—ã–¥–µ–ª—è–µ—Ç —Å–ª–µ–Ω–≥ –∏ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (B1, C1 –∏ —Ç.–¥.)

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Urban Dictionary
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª–µ–Ω–≥–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 5. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –ø–æ —Ç–µ–∫—Å—Ç—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–ª–∏–∫–∏ –≤ —Ç–æ–º –∂–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç sentence-splitter –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑** - —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏ —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å UD** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª–µ–Ω–≥–∞
- **–†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –≤—Å–µ –æ—Ç–≤–µ—Ç—ã AI –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

---

**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT
